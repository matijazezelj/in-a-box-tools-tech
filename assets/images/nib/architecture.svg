<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 480" font-family="Inter, -apple-system, sans-serif">
  <defs>
    <linearGradient id="nbg" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0d1117"/>
      <stop offset="100%" style="stop-color:#161b22"/>
    </linearGradient>
    <linearGradient id="ngrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#58a6ff"/>
      <stop offset="100%" style="stop-color:#ffa657"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="800" height="480" rx="12" fill="url(#nbg)"/>
  <rect x="1" y="1" width="798" height="478" rx="12" fill="none" stroke="#30363d" stroke-width="1"/>

  <!-- Title -->
  <text x="400" y="35" text-anchor="middle" font-size="16" font-weight="700" fill="#f0f6fc">NIB Architecture</text>

  <!-- Network Packets -->
  <rect x="30" y="60" width="140" height="50" rx="8" fill="#21262d" stroke="#58a6ff" stroke-width="1.5"/>
  <text x="100" y="82" text-anchor="middle" font-size="11" font-weight="600" fill="#58a6ff">Network Packets</text>
  <text x="100" y="98" text-anchor="middle" font-size="10" fill="#8b949e">eth0 / SPAN port</text>

  <!-- Arrow down -->
  <line x1="100" y1="110" x2="100" y2="140" stroke="#58a6ff" stroke-width="1.5" marker-end="url(#narrow)"/>
  <defs><marker id="narrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto"><path d="M0,0 L8,3 L0,6" fill="#58a6ff"/></marker></defs>

  <!-- Suricata -->
  <rect x="20" y="145" width="160" height="65" rx="8" fill="#21262d" stroke="#238636" stroke-width="1.5"/>
  <text x="100" y="170" text-anchor="middle" font-size="13" font-weight="700" fill="#238636">Suricata 7.0</text>
  <text x="100" y="186" text-anchor="middle" font-size="9" fill="#8b949e">Deep Packet Inspection</text>
  <text x="100" y="200" text-anchor="middle" font-size="9" fill="#8b949e">40,000+ signatures</text>

  <!-- EVE JSON output -->
  <text x="215" y="178" font-size="9" fill="#8b949e">EVE JSON</text>
  <line x1="180" y1="178" x2="260" y2="178" stroke="#30363d" stroke-width="1.5" stroke-dasharray="4"/>

  <!-- Branch lines from EVE -->
  <line x1="260" y1="178" x2="260" y2="90" stroke="#30363d" stroke-width="1"/>
  <line x1="260" y1="178" x2="260" y2="270" stroke="#30363d" stroke-width="1"/>
  <line x1="260" y1="178" x2="260" y2="380" stroke="#30363d" stroke-width="1"/>

  <!-- CrowdSec branch -->
  <line x1="260" y1="90" x2="330" y2="90" stroke="#30363d" stroke-width="1" marker-end="url(#narrow2)"/>
  <defs><marker id="narrow2" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto"><path d="M0,0 L8,3 L0,6" fill="#30363d"/></marker></defs>

  <!-- CrowdSec -->
  <rect x="335" y="60" width="170" height="65" rx="8" fill="#21262d" stroke="#f78166" stroke-width="1.5"/>
  <text x="420" y="82" text-anchor="middle" font-size="12" font-weight="700" fill="#f78166">CrowdSec</text>
  <text x="420" y="98" text-anchor="middle" font-size="9" fill="#8b949e">Behavioral Detection</text>
  <text x="420" y="112" text-anchor="middle" font-size="9" fill="#8b949e">Community Intel</text>

  <!-- Arrow to Bouncer -->
  <line x1="505" y1="92" x2="570" y2="92" stroke="#f78166" stroke-width="1.5" marker-end="url(#narrow3)"/>
  <defs><marker id="narrow3" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto"><path d="M0,0 L8,3 L0,6" fill="#f78166"/></marker></defs>

  <!-- Firewall Bouncer -->
  <rect x="575" y="60" width="190" height="65" rx="8" fill="#21262d" stroke="#f78166" stroke-width="1.5"/>
  <text x="670" y="82" text-anchor="middle" font-size="12" font-weight="700" fill="#f78166">Firewall Bouncer</text>
  <text x="670" y="98" text-anchor="middle" font-size="9" fill="#8b949e">iptables DROP / Router API</text>
  <text x="670" y="112" text-anchor="middle" font-size="9" fill="#c9d1d9">Blocks Attackers</text>

  <!-- Vector branch -->
  <line x1="260" y1="270" x2="330" y2="270" stroke="#30363d" stroke-width="1" marker-end="url(#narrow2)"/>

  <!-- Vector -->
  <rect x="335" y="240" width="170" height="55" rx="8" fill="#21262d" stroke="#58a6ff" stroke-width="1.5"/>
  <text x="420" y="262" text-anchor="middle" font-size="12" font-weight="700" fill="#58a6ff">Vector</text>
  <text x="420" y="278" text-anchor="middle" font-size="9" fill="#8b949e">Log Shipping &amp; Routing</text>

  <!-- Arrow to VictoriaLogs -->
  <line x1="505" y1="270" x2="570" y2="270" stroke="#58a6ff" stroke-width="1.5" marker-end="url(#narrow4)"/>
  <defs><marker id="narrow4" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto"><path d="M0,0 L8,3 L0,6" fill="#58a6ff"/></marker></defs>

  <!-- VictoriaLogs -->
  <rect x="575" y="240" width="190" height="55" rx="8" fill="#21262d" stroke="#58a6ff" stroke-width="1.5"/>
  <text x="670" y="262" text-anchor="middle" font-size="12" font-weight="700" fill="#58a6ff">VictoriaLogs</text>
  <text x="670" y="278" text-anchor="middle" font-size="9" fill="#8b949e">Log Storage &amp; Query</text>

  <!-- Arrow to Grafana -->
  <line x1="670" y1="295" x2="670" y2="340" stroke="#ffa657" stroke-width="1.5" marker-end="url(#narrow5)"/>
  <defs><marker id="narrow5" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto"><path d="M0,0 L8,3 L0,6" fill="#ffa657"/></marker></defs>

  <!-- Grafana -->
  <rect x="575" y="345" width="190" height="65" rx="8" fill="#21262d" stroke="#ffa657" stroke-width="1.5"/>
  <text x="670" y="370" text-anchor="middle" font-size="13" font-weight="700" fill="#ffa657">Grafana</text>
  <text x="670" y="386" text-anchor="middle" font-size="9" fill="#8b949e">4 Security Dashboards</text>
  <text x="670" y="400" text-anchor="middle" font-size="9" fill="#8b949e">:3001</text>

  <!-- fast.log branch -->
  <line x1="260" y1="380" x2="330" y2="380" stroke="#30363d" stroke-width="1" marker-end="url(#narrow2)"/>

  <!-- fast.log -->
  <rect x="335" y="355" width="170" height="50" rx="8" fill="#21262d" stroke="#30363d" stroke-width="1.5"/>
  <text x="420" y="377" text-anchor="middle" font-size="12" font-weight="600" fill="#8b949e">fast.log</text>
  <text x="420" y="393" text-anchor="middle" font-size="9" fill="#8b949e">Quick Alert Review</text>

  <!-- Legend -->
  <rect x="30" y="430" width="10" height="10" rx="2" fill="#238636"/>
  <text x="46" y="440" font-size="9" fill="#8b949e">Detection</text>
  <rect x="120" y="430" width="10" height="10" rx="2" fill="#f78166"/>
  <text x="136" y="440" font-size="9" fill="#8b949e">Blocking</text>
  <rect x="200" y="430" width="10" height="10" rx="2" fill="#58a6ff"/>
  <text x="216" y="440" font-size="9" fill="#8b949e">Log Pipeline</text>
  <rect x="300" y="430" width="10" height="10" rx="2" fill="#ffa657"/>
  <text x="316" y="440" font-size="9" fill="#8b949e">Visualization</text>
</svg>
